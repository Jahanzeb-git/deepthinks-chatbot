<script lang="ts">
  import { FileText, FileCode2, FileImage, FileJson, File as FileIcon } from 'lucide-svelte';

  export let filename: string;

  let icon: any = null;
  let svgPath: string | null = null;
  let viewBox: string = '0 0 24 24';

  // SVG path data for specific icons
  const icons: Record<string, { path: string; viewbox?: string }> = {
    svelte: {
      path: 'M43.429 12.23c-1.79-3.99-5.58-5.88-9.24-5.88-3.13 0-5.95 1.3-7.66 3.75l-.3 1.68-2.2-1.32c-1.9-1.15-4.1-1.72-6.23-1.72-5.78 0-10.68 4.4-11.2 10.13-.32 3.6.2 6.83 2.1 9.52l.2 1.4-2.2 1.3c-1.9 1.15-3.2 3.1-3.2 5.3 0 1.12.3 2.2.88 3.13.55.9 1.38 1.6 2.32 2.05 3.85 1.8 8.2-.2 9.6-4.1l.2-1.4 2.2-1.3c1.9-1.15 4.1-1.72 6.23-1.72 5.78 0 10.68-4.4 11.2-10.13.32-3.6-.2-6.83-2.1-9.52l-.2-1.4 2.2-1.3c1.9-1.15 3.2-3.1 3.2-5.3 0-1.12-.3-2.2-.88-3.13-.55-.9-1.38-1.6-2.32-2.05-3.85-1.8-8.2.2-9.6 4.1zM20.1 30.55c-2.6 0-5-1-6.68-2.8l-2.2-1.3-.3-1.68c-1.1-2.4-1.5-5.1-.9-7.7.5-2.6 2-4.9 4.2-6.4l2.2-1.3.3-1.68c1.1-2.4 3.2-3.9 5.6-3.9 2.6 0 5 1 6.68 2.8l2.2 1.3.3 1.68c1.1 2.4 1.5 5.1.9 7.7-.5 2.6-2 4.9-4.2 6.4l-2.2 1.3-.3 1.68c-1.1 2.4-3.2 3.9-5.6 3.9z',
      viewbox: '0 0 44 44'
    },
    react: {
      path: 'M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10c.79 0 1.55-.09 2.28-.26A9.01 9.01 0 0 1 12.01 3a9 9 0 0 1 9-9c.79 0 1.55.09 2.28.26A10.01 10.01 0 0 0 12 2zm0 4a6 6 0 1 0 0 12 6 6 0 0 0 0-12zm0 2a4 4 0 1 1 0 8 4 4 0 0 1 0-8zm-9 5a9 9 0 0 0 9 9c.79 0 1.55-.09 2.28-.26A10.01 10.01 0 0 1 3 12zm21 0a9 9 0 0 0-9-9c-.79 0-1.55.09-2.28.26A10.01 10.01 0 0 1 21 12z'
    },
    python: {
      path: 'M16.25 5.44a.9.9 0 00-1.1.1l-2.8 3.34H12v-3a.9.9 0 00-1.8 0v3H9.83l-2.8-3.33a.9.9 0 10-1.2 1l2.8 3.33H7.8a.9.9 0 00-.9.9v.9a.9.9 0 00.9.9h.05a2.7 2.7 0 01-2.7 2.7.9.9 0 000 1.8 2.7 2.7 0 012.7 2.7H7.8a.9.9 0 00-.9.9v.9a.9.9 0 00.9.9h.83l-2.8 3.34a.9.9 0 101.2 1l2.8-3.34H10.2v3a.9.9 0 001.8 0v-3h.33l2.8 3.34a.9.9 0 101.2-1l-2.8-3.34h.83a.9.9 0 00.9-.9v-.9a.9.9 0 00-.9-.9h-.05a2.7 2.7 0 012.7-2.7.9.9 0 000-1.8 2.7 2.7 0 01-2.7-2.7h.05a.9.9 0 00.9-.9v-.9a.9.9 0 00-.9-.9h-.83l2.8-3.34a.9.9 0 00-.1-1.1zM12 11.1h-1.8a.9.9 0 00-.9.9v.9a.9.9 0 00.9.9H12a2.7 2.7 0 010 5.4h-1.8a.9.9 0 00-.9.9v.9a.9.9 0 00.9.9H12a.9.9 0 00.9-.9v-8.1a.9.9 0 00-.9-.9zm.3-1.8a.9.9 0 00-.9-.9H9.6a2.7 2.7 0 010-5.4h1.8a.9.9 0 00.9-.9V1.2a.9.9 0 00-.9-.9H9.6a.9.9 0 000 1.8h.05A2.7 2.7 0 017.8 5.4a.9.9 0 000 1.8 2.7 2.7 0 012.7 2.7h-.05a.9.9 0 000 1.8H12a.9.9 0 00.9-.9v-.9a.9.9 0 00-.6-1.7z'
    },
    java: {
      path: 'M12.004 0A12 12 0 00.004 12a12 12 0 0012 12 12 12 0 0012-12 12 12 0 00-12-12zm0 21.6a9.6 9.6 0 01-9.6-9.6 9.6 9.6 0 019.6-9.6 9.6 9.6 0 019.6 9.6 9.6 9.6 0 01-9.6 9.6zm4.8-15.12h-1.92v-1.44a.72.72 0 10-1.44 0v1.44h-2.88v-1.44a.72.72 0 10-1.44 0v1.44H7.203a.48.48 0 00-.48.48v10.08a.48.48 0 00.48.48h9.6a.48.48 0 00.48-.48V6.96a.48.48 0 00-.48-.48zm-1.2 9.36h-7.2V8.16h7.2v7.2zm-3.12-8.16a.72.72 0 10-1.44 0 .72.72 0 001.44 0z'
    },
    cpp: {
      path: 'M13.55,11.99c-0.53,0-1.05,0.05-1.55,0.14c-1.94,0.36-3.63,1.58-4.6,3.23c-0.98,1.66-1.14,3.68-0.49,5.55 C7.56,22.28,9.01,23.3,10.66,23.7c1.62,0.39,3.3,0.23,4.78-0.44c-0.29-0.33-0.56-0.68-0.82-1.04c-1.13,0.59-2.48,0.78-3.77,0.48 c-1.31-0.31-2.4-1.1-3.03-2.2c-0.63-1.1-0.74-2.41-0.31-3.61c0.43-1.2,1.34-2.16,2.5-2.69c0.59-0.27,1.23-0.41,1.87-0.41 c0.7,0,1.39,0.17,2.03,0.5c0.29-0.32,0.57-0.65,0.83-1C14.96,12.1,14.26,11.99,13.55,11.99z M13.55,0C6.07,0,0,6.07,0,13.55 c0,7.47,6.08,13.55,13.55,13.55c7.47,0,13.55-6.08,13.55-13.55C27.09,6.07,21.02,0,13.55,0z M13.55,24.55 c-6.08,0-11.01-4.93-11.01-11.01c0-6.08,4.93-11.01,11.01-11.01c6.08,0,11.01,4.93,11.01,11.01C24.55,19.62,19.62,24.55,13.55,24.55z M18,6h-2v2h2V6z M22,6h-2v2h2V6z'
    },
    html: {
      path: 'M1.5 0h21l-1.91 21.563L11.977 24l-8.565-2.438L1.5 0zm17.09 4.413L5.41 4.41l.213 2.622 10.125.002-.255 2.716h-6.64l.24 2.573h6.182l-.366 3.86-2.43.706-2.43-.706-.158-1.67H5.21l.31 3.25L12 19.35l6.48-1.83.925-10.107H3.222l-.21-2.622h16.158z'
    },
    css: {
      path: 'M1.5 0h21l-1.91 21.563L11.977 24l-8.564-2.438L1.5 0zm17.09 4.413L5.41 4.41l.213 2.622 10.125.002-.255 2.716h-6.64l.24 2.573h6.182l-.366 3.86-2.43.706-2.43-.706-.158-1.67H5.21l.31 3.25L12 19.35l6.48-1.83.925-10.107H3.222l-.21-2.622h16.158z'
    },
    pdf: {
      path: 'M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5v1zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5v3zm-6.5-2h1v-1h-1v1zm7 0h1.5v-1H15v1z'
    }
  };

  $: {
    const ext = filename.split('.').pop()?.toLowerCase() || '';
    switch (ext) {
      case 'py':
        svgPath = icons.python.path;
        break;
      case 'java':
        svgPath = icons.java.path;
        break;
      case 'cpp':
      case 'cxx':
      case 'cc':
        svgPath = icons.cpp.path;
        break;
      case 'html':
        svgPath = icons.html.path;
        break;
      case 'css':
        svgPath = icons.css.path;
        break;
      case 'svelte':
        svgPath = icons.svelte.path;
        viewBox = icons.svelte.viewbox || '0 0 24 24';
        break;
      case 'jsx':
      case 'tsx':
        svgPath = icons.react.path;
        break;
      case 'json':
        icon = FileJson;
        svgPath = null;
        break;
      case 'pdf':
        svgPath = icons.pdf.path;
        break;
      case 'txt':
      case 'md':
        icon = FileText;
        svgPath = null;
        break;
      case 'png':
      case 'jpg':
      case 'jpeg':
      case 'gif':
      case 'webp':
        icon = FileImage;
        svgPath = null;
        break;
      default:
        icon = FileCode2;
        svgPath = null;
        break;
    }
  }
</script>

<div class="icon-wrapper" title={filename}>
  {#if svgPath}
    <svg xmlns="http://www.w3.org/2000/svg" viewBox={viewBox} fill="currentColor" class="icon">
      <path d={svgPath} />
    </svg>
  {:else if icon}
    <svelte:component this={icon} class="icon" />
  {/if}
</div>

<style>
  .icon-wrapper {
    width: 1.25em;
    height: 1.25em;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
  }
  .icon {
    width: 100%;
    height: 100%;
  }
</style>